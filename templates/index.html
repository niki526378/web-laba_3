<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Обработка изображений</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Лабораторная работа: Цветовые каналы</h1>
        
        <div class="form-container">
            <form method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label>Выберите изображение:</label>
                    <input type="file" name="file" accept="image/*" required>
                </div>

                <div class="sliders">
                    <h3>Настройка интенсивности каналов (0.0 - 5.0)</h3>
                    <label>Красный (R): <input type="number" step="0.1" name="r_factor" value="1.0"></label><br>
                    <label>Зеленый (G): <input type="number" step="0.1" name="g_factor" value="1.0"></label><br>
                    <label>Синий (B): <input type="number" step="0.1" name="b_factor" value="1.0"></label>
                </div>

                <div class="form-group" style="margin: 15px 0;">
                    <label>
                        <input type="checkbox" name="use_watermark"> Добавить водяной знак
                    </label>
                </div>

                <div class="captcha-box">
                    <label>Капча: Сколько будет <strong>{{ captcha_q }}</strong>?</label>
                    <input type="number" name="captcha_answer" required>
                </div>

                <button type="submit">Обработать</button>
            </form>
            {% if error %}
                <p class="error">{{ error }}</p>
            {% endif %}
        </div>

        {% if original_img %}
        <hr>
        <h2>Результаты</h2>
        {% if cls_res %}
            <p><strong>Класс изображения (Neural Network):</strong> {{ cls_res }}</p>
        {% endif %}

        <table border="1" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th>Исходное изображение</th>
                    <th>Обработанное изображение</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><img src="data:image/png;base64,{{ original_img }}" class="result-img"></td>
                    <td><img src="data:image/png;base64,{{ processed_img }}" class="result-img"></td>
                </tr>
                <tr>
                    <td><img src="data:image/png;base64,{{ orig_hist }}" class="hist-img"></td>
                    <td><img src="data:image/png;base64,{{ proc_hist }}" class="hist-img"></td>
                </tr>
            </tbody>
        </table>
        {% endif %}
    </div>
</body>
</html>
